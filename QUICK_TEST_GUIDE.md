# 快速测试指南 - 角色卡片和语音输入

## 🎯 测试目标

验证以下功能是否正常工作：
1. ✅ 角色卡片正确显示
2. ✅ 语音输入功能正常
3. ✅ 玩家可以看到自己的身份

## 📋 测试步骤

### 第一步：启动应用

```bash
cd /workspace/app-7gn2vl8qe60x
pnpm run dev
```

### 第二步：进入狼人杀游戏

1. 打开浏览器访问应用
2. 点击"狼人杀"菜单
3. 选择游戏局数（6人局/9人局/12人局）
4. 选择AI人设（至少选择5个）
5. 点击"开始游戏"按钮

### 第三步：验证角色卡片

**预期结果：**
- ✅ 进入游戏后**立即**弹出角色卡片对话框
- ✅ 显示大号Emoji图标（🐺/🔮/🧙/🏹/🛡️/👨）
- ✅ 显示角色名称（狼人/预言家/女巫/猎人/守卫/平民）
- ✅ 显示角色说明文字
- ✅ 显示阵营标识（🐺 狼人阵营 或 ✨ 好人阵营）
- ✅ 有"我知道了，开始游戏"按钮

**如果没有弹出：**
1. 打开浏览器控制台（F12）
2. 查看是否有错误信息
3. 查看控制台日志：
   - 应该看到"用户角色分配: xxx"
   - 应该看到"准备显示角色卡片"

### 第四步：验证玩家列表

**预期结果：**
- ✅ 玩家列表顶部有"查看我的角色"按钮
- ✅ 用户卡片有蓝色边框高亮
- ✅ 用户卡片显示角色名称Badge
- ✅ 用户卡片右侧显示角色Emoji
- ✅ 点击"查看我的角色"按钮可重新打开角色卡片

### 第五步：验证语音输入

**前提条件：**
- 使用Chrome或Edge浏览器
- 允许浏览器访问麦克风

**测试步骤：**
1. 在输入框下方找到"语音输入"按钮（麦克风图标）
2. 点击"语音输入"按钮
3. 浏览器会请求麦克风权限，点击"允许"
4. 看到按钮变为红色"停止录音"
5. 对着麦克风说话（例如："我觉得3号玩家很可疑"）
6. 说完后等待1-2秒
7. 识别的文字会自动填入输入框

**预期结果：**
- ✅ 点击后按钮变为红色
- ✅ 显示"开始录音"提示
- ✅ 语音转换为文字填入输入框
- ✅ 显示"识别成功"提示
- ✅ 可以手动修改识别的文字
- ✅ 点击"发送"按钮发送消息

**如果语音输入不可用：**
- 检查是否使用Chrome/Edge浏览器
- 检查麦克风权限是否允许
- 检查网络连接是否正常

### 第六步：验证游戏流程

1. 使用文字或语音输入发言
2. 点击"发送"按钮
3. AI会自动回复
4. 点击"进入下一阶段"切换游戏阶段

**预期结果：**
- ✅ 发言显示在聊天区域
- ✅ AI会根据人设回复
- ✅ 游戏阶段正确切换

## 🐛 常见问题

### 问题1：角色卡片没有弹出

**解决方案：**
1. 刷新页面重新进入游戏
2. 点击"查看我的角色"按钮手动打开
3. 检查浏览器控制台是否有错误

### 问题2：语音输入按钮不显示

**原因：** 浏览器不支持语音识别

**解决方案：**
- 使用Chrome浏览器（推荐）
- 使用Edge浏览器
- 使用文字输入代替

### 问题3：语音识别不准确

**解决方案：**
- 在安静环境下使用
- 清晰地说话
- 使用短句
- 手动修改识别错误的内容

### 问题4：角色分配不合理

**说明：** 角色是随机分配的，符合游戏配置

**验证方法：**
- 多次进入游戏，角色应该不同
- 检查角色数量是否符合配置

## 📊 测试检查清单

### 角色卡片功能
- [ ] 进入游戏后立即弹出
- [ ] 显示正确的角色信息
- [ ] 显示角色Emoji图标
- [ ] 显示阵营信息
- [ ] 可以关闭卡片
- [ ] 可以重新打开卡片

### 玩家列表功能
- [ ] 用户卡片有特殊标识
- [ ] 显示角色名称
- [ ] 显示角色图标
- [ ] "查看我的角色"按钮可用

### 语音输入功能
- [ ] 语音按钮显示（Chrome/Edge）
- [ ] 可以开始录音
- [ ] 语音转文字正确
- [ ] 可以停止录音
- [ ] 识别结果填入输入框

### 游戏流程
- [ ] 可以发送消息
- [ ] AI会回复
- [ ] 可以切换阶段
- [ ] 发言记录正确显示

## 🎮 测试场景

### 场景1：狼人玩家
1. 进入游戏，分配到狼人角色
2. 角色卡片显示🐺和"狼人"
3. 阵营显示"🐺 狼人阵营"（红色）
4. 玩家列表显示狼人信息

### 场景2：预言家玩家
1. 进入游戏，分配到预言家角色
2. 角色卡片显示🔮和"预言家"
3. 阵营显示"✨ 好人阵营"（蓝色）
4. 说明显示"每晚可以查验一名玩家的身份"

### 场景3：使用语音输入
1. 点击语音输入按钮
2. 说："我是预言家，昨晚验了3号是好人"
3. 文字正确填入输入框
4. 点击发送
5. AI根据发言回复

## 📝 测试报告模板

```
测试时间：____年__月__日
测试人员：________
浏览器：Chrome / Edge / Firefox / Safari
版本：________

【角色卡片测试】
- 是否弹出：是 / 否
- 显示是否正确：是 / 否
- 问题描述：________________

【语音输入测试】
- 按钮是否显示：是 / 否
- 识别是否准确：是 / 否
- 问题描述：________________

【整体评价】
- 功能完整性：优 / 良 / 中 / 差
- 用户体验：优 / 良 / 中 / 差
- 建议：________________
```

## 🔍 调试技巧

### 查看角色分配日志

打开浏览器控制台（F12），查看：
```
用户角色分配: werewolf
准备显示角色卡片
```

### 查看状态

在控制台输入：
```javascript
// 查看当前角色
console.log(userRole);

// 查看是否显示角色卡片
console.log(showRoleCard);

// 查看玩家列表
console.log(players);
```

## ✅ 测试通过标准

所有以下条件都满足：
1. ✅ 角色卡片正确弹出并显示
2. ✅ 玩家可以看到自己的角色
3. ✅ 语音输入功能正常（Chrome/Edge）
4. ✅ 游戏流程正常运行
5. ✅ 没有控制台错误

---

**测试版本**: V3.0-Alpha  
**更新时间**: 2025-01-10  
**状态**: 准备测试
