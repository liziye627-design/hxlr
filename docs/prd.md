# 次元阅关游戏AI伴侣系统需求文档

## 1. 项目概述

### 1.1 系统名称
次元阅关 - 游戏AI伴侣系统

### 1.2 系统描述
次元阅关是在Soul平台内集成的虚拟游戏伙伴系统，通过AI NPC与用户进行实时互动游戏（狼人杀、剧本杀、数字冒险等），同时支持1V1和多人游戏模式。AI伴侣不仅参与游戏进程，还充当「故事讲述者」和「游戏引导者」的角色，为用户提供随时可参与的社交游戏体验。

### 1.3 核心价值主张
- 解决组织真人游戏困难，AI可以秒速配齐，随时开局
- 避免游戏过程中的「猪队友」问题，AI伴侣策略稳定
- 将游戏中的互动数据直接转化为匹配信号，深化社交
- AI自动引导游戏规则，新手友好
- 提供无限的角色和剧本体验

## 2. 核心功能

### 2.1 AI狼人杀系统

#### 2.1.1 界面设计
- **界面风格**：采用经典狼人杀游戏界面风格，圆桌布局，角色头像环绕展示
- **房间选择**：首页展示三种局数选项卡：6人局、9人局、12人局
- **角色展示**：每个座位显示玩家/AI头像、昵称、状态标识

#### 2.1.2 游戏模式
- **6人局**：标准配置（2狼2民1预言家1女巫）\n- **9人局**：标准配置（3狼3民1预言家1女巫1猎人）
- **12人局**：标准配置（4狼4民1预言家1女巫1猎人1守卫1白痴）
- **对战选择**：支持PVE（仅与AI对战）或PVP（混合真人）模式

#### 2.1.3 AI角色人设系统
- **预设人设库**：
  - 逻辑型：发言严谨，注重推理链条
  - 直觉型：凭感觉判断，情绪化表达
  - 谨慎型：保守发言，不轻易站队
  - 激进型：强势带节奏，敢于对抗
  - 伪装高手：狼人身份时擅长伪装
  - 心理战术：善于观察他人破绽
  - 隐形杀手：低调潜伏型狼人
  - 配合型：团队协作能力强
  - 新手型：发言简单，容易被带节奏
  - 老手型：经验丰富，发言有深度

- **用户自定义人设**：
  - 用户可自由创建AI人设，设置性格标签、发言风格、策略倾向
  - 支持调整人设的激进度、逻辑性、情绪化程度等参数
  - 可为自定义人设命名、设置头像和个性签名

- **发言记录与人设生成功能**：
  - **模拟对局记录模式**：用户可开启「人设记录模式」进入模拟对局
  - **发言采集**：系统自动记录指定玩家（自己或其他人）在对局中的所有发言内容
  - **行为标注**：记录该玩家在不同情况下的反应（如被质疑时的应对、拿到好人/狼人身份时的发言特点、投票倾向等）
  - **AI分析总结**：对局结束后，AI自动分析发言内容，提取以下特征：
    - 发言风格（简洁/详细、理性/感性、主动/被动）
    - 逻辑习惯（先结论后推理/先推理后结论）
    - 情绪表达（冷静/激动、幽默/严肃）
    - 策略倾向（保守/激进、独立思考/跟随大流）
    - 身份特征（好人时的表现、狼人时的伪装方式）
  - **人设生成**：基于AI总结生成新的人设卡片，包含：
    - 人设名称（可自定义）
    - 性格标签（系统自动生成）
    - 典型发言示例
    - 不同情境下的反应模式
  - **人设库管理**：生成的人设自动保存至个人人设库，可在后续对局中选用

#### 2.1.4 游戏流程
快速游戏/排位游戏 → 选择局数（6/9/12人） → 选择AI人设 → 系统调度 → AI主持介绍 → 标准狼人杀流程 → 战绩报告 → 真人匹配推荐

#### 2.1.5 狼人杀游戏状态流转
**1. 初始化阶段 (Initialization)**
- 房间创建：设定人数（6人、9人、12人局）
- 角色分配：使用随机算法将角色分配给Player ID
- 状态重置：所有玩家状态设为Alive，所有技能冷却设为Ready

**2. 黑夜阶段 (Night Phase)**
- **行动顺序**：
  1. 守卫：选择守护一名玩家，该玩家获得is_guarded = true标记
  2. 狼人：语音/文字交流后投票选择击杀目标，目标获得marked_for_death = true标记
  3. 女巫：看到狼人击杀目标后选择用药（解药/毒药），修改目标状态
  4. 预言家：选择一名玩家查询阵营，服务器返回Good或Bad
  5. 猎人：系统检查猎人是否死亡及死亡原因，更新技能状态
- **结算优先级**：女巫行动优先于狼人，同守同救按奶穿肠规则处理

**3. 结算阶段 (Resolution Phase)**
- 处理状态冲突：同守同救、同救同毒等情况的逻辑判定
- 死亡结算：将玩家Alive状态改为Dead

**4. 白天阶段 (Day Phase)**
- 公布死讯：服务器广播昨夜死亡名单
- 警长竞选：上警→发言→退水→投票→警徽移交
- 轮流发言：语音流或文字发言，队列控制发言顺序
- 放逐投票：全员投票→计票→平票PK→再次投票
- 遗言：被放逐者有机会发表遗言

#### 2.1.6 角色身份抽取
- **身份隐藏**：游戏开始时随机抽取角色身份，用户只知道自己的身份
- **夜间操作**：只有有身份的角色才能执行对应操作
- **角色图片**：
  - 狼人：使用image.png
  - 预言家：使用image-2.png
  - 女巫：使用image-3.png
  - 守卫：使用image-4.png
  - 平民：使用image-5.png

#### 2.1.7 多模态交互功能
- **语音输入**：用户可使用语音进行游戏交流和操作
- **TTS转换**：AI角色支持语音输出，实现语音对话
- **STT转换**：语音输入自动转换为文本处理
- **真人参与**：支持与真人玩家混合对战模式

### 2.2 AI剧本杀系统
- **主持功能**：AI担任主持人，拥有完整的故事和线索
- **参与模式**：支持2-6人参与，包含「共探」「对抗」「混合」模式
- **故事分类**：悬疑推理、恐怖惊悚、浪漫推理、奇幻冒险、现代职场
- **难度分级**：新手（线索明显）、普通（标准难度）、困难（线索隐藏）、疯狂（多重反转）
- **互动机制**：AI根据用户提问策略改变态度，依据社交评分调整配合度

### 2.3 AI数字冒险系统
- **游戏类型**：文本冒险体验，所有NPC由AI扮演
- **故事推进**：用户通过对话选择推动故事发展
- **模式支持**：单人或多人竞合模式
- **NPC多样性**：秘密守护者、商人角色、敌对角色、盟友角色
- **互动方式**：通过对话说服/欺骗/合作，达成不同游戏结局

### 2.4 AI伴侣个性化系统
- **伴侣类型**：
  - 策略高手「阿尔法」：逻辑清晰，善于分析
  - 人气明星「水蓝」：热情活跃，善于调动气氛
  - 神秘高冷「暗影」：沉着冷静，深思熟虑
  - 萌新助手「小新」：热心肠，保护欲强
- **成长机制**：AI学习用户游戏风格，发言策略越来越贴近用户偏好
- **亲密度系统**：解锁独特互动对话和背景故事

### 2.5 社交融合功能
- **数据转化**：游戏互动数据转化为真人匹配信号
- **排行榜体系**：战斗力排行、魅力排行、配合排行
- **匹配推荐**：基于游戏中的信任度和互动质量推荐真人玩家
- **社交转化**：显示「你们在《狼人杀》中很默契」等匹配信息

## 3. 技术架构

### 3.1 核心技术要求
- **实时对话生成**：支持语音和文字的自然对话
- **策略决策引擎**：基于游戏状态和对手行为的实时决策
- **情感表达系统**：表现真实的情绪变化和战术思考
- **故事引擎**：动态生成故事分支和NPC对话
- **博弈论引擎**：狼人杀的策略最优化
- **自然语言理解**：理解用户的复杂指令和隐含意图
- **玩家行为预测**：基于历史数据预测用户下一步行动
- **发言分析引擎**：提取发言特征，生成人设模型
- **人设模拟引擎**：基于人设参数生成符合特征的AI发言
- **语音处理**：TTS和STT转换模块
- **多模态交互**：语音/文字混合处理

### 3.2 大语言模型配置
- **模型选择**：支持多种大语言模型API配置
- **人设绑定**：每个AI人设可选择对应的大模型类型
- **API管理**：用户可自定义配置各模型的API接口
- **适配层**：统一接口适配不同大模型的调用方式

### 3.3 性能指标
- 对话延迟：<500ms
- AI决策延迟：<1s
- 并发支持：10万+并发游戏会话
- 模型大小：单个伴侣模型<5GB
- 人设分析时间：<3分钟/局

## 4. 商业模式

### 4.1 收费结构
- **免费基础版**：每天3局游戏，1个AI伴侣，基础故事库
- **付费VIP版**（¥29.9/月）：无限游戏，全部AI伴侣，高级故事库，排位赛权限
- **季卡/年卡**（¥79.9/季度，¥199/年）：所有VIP功能，额外定制权限
- **道具付费**：AI伴侣皮肤（¥2.9-9.9），特殊故事体验包（¥4.9-19.9）

### 4.2 收入预测
基于Soul月活2000万，游戏功能渗透率15%（300万用户）：
- VIP转化率8% = 24万VIP用户，月收入716万元
- 道具消费率10% = 30万道具消费，月收入150万元
- 月收入合计：约866万元，年收入预期：约1亿元+

## 5. 开发规划

### 5.1 第一阶段（1-2个月）
- AI狼人杀基础版，4个难度
- 4个AI伴侣
- 20个剧本杀故事
- 基础排行榜

### 5.2 第二阶段（3-4个月）
- AI剧本杀完整版，50+故事
- AI数字冒险，10个故事线
- 伴侣自定义功能
- 社团/工会系统

### 5.3 第三阶段（5-6个月+）
- 国际故事库引进\n- AI伴侣记忆系统
- 跨服竞赛系统
- 内容创作工具

## 6. 风险控制

### 6.1 主要风险
- AI行为真实性问题：持续优化，邀请专业编剧参与
- 内容更新压力：建立用户共创系统
- 技术性能瓶颈：采用分布式架构，定期压测
- 用户沉迷问题：建立游戏时间提醒，家长控制功能
- 社交骚扰风险：完善举报系统，AI监测异常行为

### 6.2 预期效果指标
- 游戏功能日活渗透：15%+
- 平均游戏时长：20分钟+
- VIP转化率：8%+
- 用户留存率提升：+18%
- 游戏→真人匹配转化：12%+

## 7. 系统设计风格

### 7.1 视觉设计
- **配色方案**：深蓝主色调配合紫色渐变，营造神秘科技感
- **界面布局**：卡片式布局，突出游戏房间和AI伴侣展示
- **动画效果**：流畅的页面切换动画，AI角色的微表情动画
- **图标风格**：扁平化设计配合细腻阴影，统一的圆角处理

### 7.2 交互设计
- **操作反馈**：即时的点击反馈和状态提示
- **语音交互**：支持语音输入和AI语音回复
- **手势操作**：滑动切换游戏模式，长按查看详情
- **个性化界面**：根据用户偏好调整界面主题和AI伴侣显示